<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Manipulation | Data Science for Policy Analysts</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Manipulation | Data Science for Policy Analysts" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Manipulation | Data Science for Policy Analysts" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Chris Lavoie" />


<meta name="date" content="2019-07-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="whatis.html">
<link rel="next" href="final-words.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#the-policy-analysts-challenge"><i class="fa fa-check"></i><b>2.1</b> The Policy Analyst’s Challenge</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#the-data-scientists-challenge"><i class="fa fa-check"></i><b>2.2</b> The Data Scientist’s Challenge</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#information-asymmetry"><i class="fa fa-check"></i><b>2.3</b> Information Asymmetry</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#goals"><i class="fa fa-check"></i><b>2.4</b> Goals</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="whatis.html"><a href="whatis.html"><i class="fa fa-check"></i><b>3</b> What is a Data Scientist?</a></li>
<li class="chapter" data-level="4" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a></li>
<li class="chapter" data-level="5" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>5</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Policy Analysts</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-manipulation" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Data Manipulation</h1>
<p>This expertise in data manipulation comes thanks to the toolkit at their disposal. Rather than relying on old proprietary software, or be limited by a graphical interface, data scientists almost always use programming languages to manipulate data. Because of the power and flexibility of these programming languages like <em>Python</em> and <em>R</em>, they’re able to work with gigabytes of data with millions of rows as easily as they would work with ten rows. They aren’t daunted by size. In fact, most data scientists I’ve met salivate over massive datasets, because more data gives them many more possibilities.</p>
<p>These programming languages are specialized to move data into and out of different environments and formats. A data scientist can pull data from the a hundred websites, combine the relevant information into one dataset and perform statistical analysis from there. Often, they spend a lot of time cleaning the dataset. They purge it of impurities, impute missing values and convert messy data into a beautiful tabular dataset. In fact, the saying goes that eighty percent of a data scientist’s time is spent cleaning data.</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> basis_expansion(data_frame, order<span class="op">=</span><span class="dv">2</span>, interactions <span class="op">=</span> <span class="va">False</span>):
    <span class="co"># Creates empty dataframe</span>
    <span class="co"># We will append our new columns into the df, and then</span>
    <span class="co"># concatenate our new frame to the original</span>
    new_df <span class="op">=</span> pd.DataFrame()
    relevant_col_list <span class="op">=</span> []
    
    
    <span class="kw">def</span> check_if_relevant(df):
        <span class="cf">for</span> col <span class="kw">in</span> df.columns:
            unique_vals <span class="op">=</span> <span class="bu">list</span>(df[col].unique())
            <span class="cf">if</span> <span class="kw">not</span> (<span class="bu">len</span>(unique_vals) <span class="op">==</span> <span class="dv">2</span> <span class="kw">and</span> <span class="dv">0</span> <span class="kw">in</span> unique_vals <span class="kw">and</span> <span class="dv">1</span> <span class="kw">in</span> unique_vals):
                relevant_col_list.append(col)
            
    check_if_relevant(data_frame)
    <span class="cf">for</span> exponent <span class="kw">in</span> (<span class="bu">range</span>(<span class="dv">1</span>,order)):
        exponent <span class="op">+=</span> <span class="dv">1</span> <span class="co"># For each exponent, add columns</span>
        <span class="cf">for</span> col <span class="kw">in</span> relevant_col_list:
       
            new_df[col<span class="op">+</span><span class="st">&#39;**&#39;</span><span class="op">+</span><span class="bu">str</span>(exponent)] <span class="op">=</span> data_frame[col]<span class="op">**</span>exponent
    
    <span class="cf">if</span> interactions:
        <span class="cf">for</span> col1 <span class="kw">in</span> data_frame.columns:
            <span class="cf">for</span> col2 <span class="kw">in</span> data_frame.columns:
                <span class="cf">if</span> col1 <span class="op">!=</span> col2:
                    new_df[col1<span class="op">+</span><span class="st">&quot;*&quot;</span><span class="op">+</span>col2] <span class="op">=</span> data_frame[col1]<span class="op">*</span>data_frame[col2]
    new_dataframe <span class="op">=</span> pd.concat([data_frame, new_df], axis<span class="op">=</span><span class="dv">1</span>)
    <span class="cf">return</span> new_dataframe</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="whatis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="final-words.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["DS_for_PA.pdf", "DS_for_PA.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
